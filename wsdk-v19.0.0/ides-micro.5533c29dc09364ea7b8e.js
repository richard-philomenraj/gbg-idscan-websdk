/*!
 * GBG - WJCS
 * Version: 19.0.0
 * Build Mode: Production
 * Build Timestamp: 1726219598311
 * Build Time: 2024-09-13T09:26:38.311Z
 * Chunk Hash: 5533c29dc09364ea7b8e
 */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("Idscan",[],r):"object"==typeof exports?exports.Idscan=r():(e.GBG=e.GBG||{},e.GBG.Idscan=r())}(this,(function(){return function(e){var r={};function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=r,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)o.d(t,n,function(r){return e[r]}.bind(null,n));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="",o(o.s=195)}({195:function(e,r,o){"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var r,o=1,t=arguments.length;o<t;o++)for(var n in r=arguments[o])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.IdesMicroWorker=void 0;var n=o(48),s=function(e){var r=this;this.postMessage=function(e,o,t){return new Promise((function(n){return n(r.workerGlobalContext.postMessage({id:e,message:o,data:t}))}))},this.onError=function(e){return r.postMessage("",n.IdesMicroWorkerMessages.Error,t({},e))},this.onMessage=function(e){var o=e.data;switch(o.message){case n.IdesMicroWorkerMessages.PerformQualityCheck:return r.onPerformQualityCheck(o.id,o.data);case n.IdesMicroWorkerMessages.Terminate:return r.postMessage(o.id,n.IdesMicroWorkerMessages.Terminate).then((function(){return r.workerGlobalContext.close()}));case n.IdesMicroWorkerMessages.Initialise:return r.onInitialise(o.data.asmScriptUrl,o.data.timeout,o.data.timeLogsEnabled).then((function(){return r.postMessage(o.id,n.IdesMicroWorkerMessages.ReadyToProcess)})).catch((function(){return r.postMessage(o.id,n.IdesMicroWorkerMessages.Error)}))}},this.onInitialise=function(e,o,t){return void 0===e&&(e="./idesmicro_asm.js"),void 0===o&&(o=6e4),void 0===t&&(t=!1),new Promise((function(n,s){var i=performance.now();if(r.timeLogsEnabled=t,r.timeLogsEnabled&&console.log("smart capture time logs enabled: "+t),r.idesMicro){var a=performance.now();return t&&console.log("IDES worker onInitialise method took: "+(a-i)+" miliseconds"),n()}r.workerGlobalContext.importScripts(e);var c=setTimeout((function(){return s()}),o);return r.workerGlobalContext.Initidesmicro().then((function(e){clearTimeout(c),r.idesMicro=e,r.frameSelection=new r.idesMicro.frame_selection;var o=performance.now();t&&console.log("IDES worker onInitialise method took: "+(o-i)+" miliseconds"),n()}))}))},this.onPerformQualityCheck=function(e,o){var t=o.image,s=performance.now();return r.checkQuality(t).then((function(o){return r.postMessage(e,n.IdesMicroWorkerMessages.CheckComplete,o)})).then((function(){var e=performance.now();r.timeLogsEnabled&&console.log("| onPerformQualityCheck method took: "+(e-s)+" ms |")})).catch((function(o){return r.postMessage(e,n.IdesMicroWorkerMessages.CheckFailed,o.message)}))},this.checkQuality=function(e){return r.checkImageQuality(e).then((function(e){var o=e.glare,t=e.blur,n=e.low_res,s=e.out_of_frame,i=e.document,a=e.done,c=performance.now();if(a){var l=r.frameSelection.get_best_frame(),u=new Uint8Array(r.idesMicro.HEAPU8.buffer,l.bufferPointerAddress,l.size),d=new Uint8Array(u);r.frameSelection.clear();var f=Promise.resolve({quality:{blurCheck:!0,glareCheck:!0,resolutionCheck:!0,coordinateCheck:!0},coords:[],image:d}),m=performance.now();return r.timeLogsEnabled&&console.log("| checkQuality method took: "+(m-c)+" ms |"),f}var g=Promise.resolve({quality:{blurCheck:!t,glareCheck:!o,resolutionCheck:!n,coordinateCheck:!s&&i},coords:[]});return m=performance.now(),r.timeLogsEnabled&&console.log("| checkQuality method took: "+(m-c)+" ms |"),g}))},this.checkImageQuality=function(e){return new Promise((function(o){var t=performance.now(),n=e.length|e.BYTES_PER_ELEMENT,s=r.idesMicro._malloc(n),i=new Uint8Array(r.idesMicro.HEAPU8.buffer,s,n);i.set(e);var a=performance.now(),c=r.frameSelection.add_frame(i.byteOffset,e.length),l=performance.now();return r.timeLogsEnabled&&console.log("| add_frame method took: "+(l-a)+" ms |"),r.idesMicro._free(s),void 0===c?o({glare:!1,blur:!1,low_res:!1,out_of_frame:!1,document:!1,done:!1}):(l=performance.now(),r.timeLogsEnabled&&console.log("| checkImageQuality method took: "+(l-t)+" ms |"),o(c))}))},this.workerGlobalContext=e,this.workerGlobalContext.addEventListener("message",this.onMessage),this.workerGlobalContext.addEventListener("error",this.onError)};r.IdesMicroWorker=s,r.default=new s(self)},48:function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IdesMicroWorkerMessages=void 0,function(e){e.CheckComplete="CheckComplete",e.CheckFailed="CheckFailed",e.Initialise="Initialise",e.Terminate="Terminate",e.LoadingResources="LoadingResources",e.PerformQualityCheck="PerformQualityCheck",e.ReadyToProcess="ReadyToProcess",e.Error="Error"}(r.IdesMicroWorkerMessages||(r.IdesMicroWorkerMessages={}))}})}));